#! /bin/sh -e

PREFIX=@prefix@
XERCESJAR=@PATHTOXERCES@
LOGJAVA=@PATHTOLOGJAVA@
RTJAR=@PATHTORTJAR@
JAVA=@PATHTOJAVA@
CDKLIBDIR=@CDKLIBDIR@
CDKDIR=@CDKDIR@

JARLIBS=`ls -1 ${CDKLIBDIR}/*.jar | perl -ne "s/\n|\r/:/g; print;"`
CDKLIBS=`ls -1 ${CDKDIR}/cdk*.jar | perl -ne "s/\n|\r/:/g; print;"`
CLASSPATH=${RTJAR}:${LOGJAVA}:${XERCESJAR}:${JARLIBS}:${CDKLIBS}

# Collect -D options as java arguments
command=${JAVA}
while [ `echo $1 | egrep '^-D' | wc -l` != 0 ]; do
        command="$command $1"
        shift
done

junit_gui="-Dcdk.debugging=true junit.awtui.TestRunner"
while getopts t o; do
    case $o in
        t)
            junit_gui="-Dcdk.debugging=false junit.textui.TestRunner"
            ;;
    esac
done

${command} -cp ${CLASSPATH} ${junit_gui} $*
