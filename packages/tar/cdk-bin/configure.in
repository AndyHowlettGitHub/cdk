dnl
dnl $Id$
dnl
AC_INIT()
AM_INIT_AUTOMAKE(cdk-bin, `cat VERSION`)

dnl Checks for programs.
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET

AC_MSG_CHECKING(for CDK libraries)
if test -f "$prefix/lib/cdk/xerces-1.3.0.jar"
then
    CDKLIBDIR="$prefix"
    AC_MSG_RESULT($CDKLIBDIR)
else
    AC_MSG_RESULT(no)
	echo "The required libraries for CDK are not installed. Please download and install"
	echo "the cdk-libs distribution."
    exit 1
fi

AC_CHECK_PROG(HASJAVA, java, yes, no)
if test "xyes" = "x$HASJAVA"
then
        AC_PATH_PROG(PATHTOJAVA, java, no)
fi

AC_ARG_WITH(java3ddir,
      [  --with-java3ddir=DIR    path to the Java 3D installation directory 
        ],
      [  if test -n "$withval"
         then
          JAVA3DDIR="$withval"
         fi
        ])

AC_MSG_CHECKING(for Java3D lib)
if test -f "$JAVA3DDIR/lib/ext/j3dcore.jar"
    AC_MSG_RESULT("$JAVA3DDIR/lib/ext/j3dcore.jar")
    PATHTO3DJAR="$JAVA3DDIR/lib/ext/j3dcore.jar:$JAVA3DDIR/lib/ext/j3dutils.jar:$JAVA3DDIR/lib/ext/vecmath.jar"
then
    if test "x$prefix" = xNONE
    then
        # order these with prefered one at the end
        try_dirs="$ac_default_prefix"
    else
        try_dirs="$prefix"
    fi

    # Debian GNU/Linux Blackdown path
    try_dirs="$try_dirs /usr/lib/j2re1.3"

    for d in $try_dirs
    do
        if test -f "$d/j3dcore.jar"
        then 
            AC_MSG_RESULT("$d/j3dcore.jar")
            PATHTO3DJAR="$d/j3dcore.jar:$d/j3dutils.jar:$d/vecmath.jar"
        fi
    done
fi
AC_SUBST(PATHTO3DJAR)

AC_MSG_CHECKING(for rt.jar lib)
for d in "/usr/lib/j2re1.3/lib"
do
    if test -f "$d/rt.jar"
    then
        AC_MSG_RESULT("$d/rt.jar")
        PATHTORTJAR="$d/rt.jar"
    fi
done
AC_SUBST(PATHTORTJAR)

dnl needed for check_xml
AC_PATH_PROGS(PATHTONSGMLS, onsgmls nsgmls, no)

AC_OUTPUT([
   Makefile
   bin/Makefile
   bin/cdk-dbadmin
   bin/cdk-fileconvert
   bin/cdk-view
   jar/Makefile
   man/Makefile
])

