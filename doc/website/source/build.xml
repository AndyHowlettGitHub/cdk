<project name="CDK Website Build File" default="website" basedir=".">

  <property name="build.dir" value="../target"/>

  <target id="layout" name="layout" depends="javancss, keyword.index">
    <xslt in="layout.xml" out="autolayout.xml" style="xsl/autolayout.xsl"/>
  </target>

  <target name="website-from-autolayout" depends="layout">
    <!-- does should work, but it doesn't -->
    <xslt in="autolayout.xml" destdir="${build.dir}/" style="xsl/tabular.xsl"/>
  </target>

  <target id="clean" name="clean">
    <delete file="javancss-tmp.xml"/>
    <delete file="javancss-data.xml"/>
    <delete file="javadoc-data.xml"/>
    <delete>
      <fileset dir="${build.dir}/" includes="*.html"/>
    </delete>
  </target>
  
  <target id="website" name="website" depends="layout, javancss, keyword.index">
    <!-- note the duplication. If I understand the Ant website correctly, it should
         be possible to use the includes="*.xml" instead with Ant 1.5.2/Xalan and the
         reloadstylesheet attribute. But I only have Ant 1.5.1 at the moment :( -->
    <xslt in="agenda.xml" out="${build.dir}/agenda.html" style="xsl/tabular.xsl"/>
    <xslt in="api.xml" out="${build.dir}/api.html" style="xsl/tabular.xsl"/>
    <xslt in="biblio.xml" out="${build.dir}/biblio.html" style="xsl/tabular.xsl"/>
    <xslt in="changelog.xml" out="${build.dir}/changelog.html" style="xsl/tabular.xsl"/>
    <xslt in="contact.xml" out="${build.dir}/contact.html" style="xsl/tabular.xsl"/>
    <xslt in="development.xml" out="${build.dir}/development.html" style="xsl/tabular.xsl"/>
    <xslt in="documentation.xml" out="${build.dir}/documentation.html" style="xsl/tabular.xsl"/>
    <xslt in="download.xml" out="${build.dir}/download.html" style="xsl/tabular.xsl"/>
    <xslt in="guide-docs.xml" out="${build.dir}/guide-docs.html" style="xsl/tabular.xsl"/>
    <xslt in="guide-library-development.xml" out="${build.dir}/guide-library-development.html" style="xsl/tabular.xsl"/>
    <xslt in="guide-packages.xml" out="${build.dir}/guide-packages" style="xsl/tabular.xsl"/>
    <xslt in="guide-website-development.xml" out="${build.dir}/guide-website-development.html" style="xsl/tabular.xsl"/>
    <xslt in="guide.xml" out="${build.dir}/guide.html" style="xsl/tabular.xsl"/>
    <xslt in="intro.xml" out="${build.dir}/intro.html" style="xsl/tabular.xsl"/>
    <xslt in="javadoc-stats.xml" out="${build.dir}/javadoc-stats.html" style="xsl/tabular.xsl"/>
    <xslt in="javancss-stats.xml" out="${build.dir}/javancss-stats.html" style="xsl/tabular.xsl"/>
    <xslt in="keywordindex.xml" out="${build.dir}/keywordindex.html" style="xsl/tabular.xsl"/>
    <xslt in="libraries.xml" out="${build.dir}/libraries.html" style="xsl/tabular.xsl"/>
    <xslt in="man-dbadmin.xml" out="${build.dir}/man-dbadmin.html" style="xsl/tabular.xsl"/>
    <xslt in="man-download.xml" out="${build.dir}/man-download.html" style="xsl/tabular.xsl"/>
    <xslt in="man-fileconvert.xml" out="${build.dir}/man-fileconvert.html" style="xsl/tabular.xsl"/>
    <xslt in="man-test.xml" out="${build.dir}/man-test.html" style="xsl/tabular.xsl"/>
    <xslt in="manpages.xml" out="${build.dir}/manpages.html" style="xsl/tabular.xsl"/>
    <xslt in="reference.xml" out="${build.dir}/reference.html" style="xsl/tabular.xsl"/>
    <xslt in="related.xml" out="${build.dir}/related.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc.xml" out="${build.dir}/rfc.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc1.xml" out="${build.dir}/rfc1.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc2.xml" out="${build.dir}/rfc2.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc3.xml" out="${build.dir}/rfc3.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc4.xml" out="${build.dir}/rfc4.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc5.xml" out="${build.dir}/rfc5.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc6.xml" out="${build.dir}/rfc6.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc7.xml" out="${build.dir}/rfc7.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc8.xml" out="${build.dir}/rfc8.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc9.xml" out="${build.dir}/rfc9.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc10.xml" out="${build.dir}/rfc10.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc11.xml" out="${build.dir}/rfc11.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc12.xml" out="${build.dir}/rfc12.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc13.xml" out="${build.dir}/rfc13.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc14.xml" out="${build.dir}/rfc14.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc15.xml" out="${build.dir}/rfc15.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc16.xml" out="${build.dir}/rfc16.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc17.xml" out="${build.dir}/rfc17.html" style="xsl/tabular.xsl"/>
    <xslt in="rfc18.xml" out="${build.dir}/rfc18.html" style="xsl/tabular.xsl"/>
    <xslt in="screenshots.xml" out="${build.dir}/screenshots.html" style="xsl/tabular.xsl"/>
    <xslt in="software.xml" out="${build.dir}/software.html" style="xsl/tabular.xsl"/>
    <xslt in="thelibrary.xml" out="${build.dir}/thelibrary.html" style="xsl/tabular.xsl"/>
    <xslt in="website.xml" out="${build.dir}/website.html" style="xsl/tabular.xsl"/>
    <xslt in="whoiswho.xml" out="${build.dir}/whoiswho.html" style="xsl/tabular.xsl"/>
  </target>

  <target name="javancss">
    <java classname="javancss.Main" fork="yes"
      output="javancss-tmp.xml">
      <arg value="-package"/>
      <arg value="-xml"/>
      <arg value="-recursive"/>
      <arg value="../../../src"/>
      <classpath>
        <pathelement location="javancss/lib/javancss.jar"/>
        <pathelement location="javancss/lib/ccl.jar"/>
        <pathelement location="javancss/lib/jhbasic.jar"/>
      </classpath>
    </java>
    <xslt in="javancss-tmp.xml" out="javancss-data.xml" style="xsl/javancss2docbook.xsl"/>
    <xslt in="javancss-tmp.xml" out="javadoc-data.xml" style="xsl/javancss2docbook-javadoc.xsl"/>
  </target>
  
  <target id="keyword.index" name="keyword.index">
    <ant dir="../../javadoc/" antfile="build.xml" target="keyword.index"/>
    <move file="keyword.index.xml" todir="../../javadoc"/>
  </target>

</project>
