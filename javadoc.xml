<project name="CDK" default="html" basedir=".">

    <property name="javadoc.dir" value="doc/api" />
    <property name="pathtojava3d" value="" />
    <property name="build" value="build" />
    <property name="src" value="src" />

    <path id="project.class.path">
        <pathelement location="." />
        <fileset dir="jar">
            <include name="*.jar" />
        </fileset>
        <fileset dir="jar/libio">
            <include name="*.jar" />
        </fileset>
        <fileset dir="${pathtojava3d}">
            <include name="*.jar" />
        </fileset>
    </path>

    <path id="fop.class.path">
        <fileset dir="doc/jar">
            <include name="*.jar" />
        </fileset>
    </path>

    <target name="html">        
        <mkdir dir="${javadoc.dir}" />

        <!-- Call javacc target in build.xml to re-generate the source code -->
        <ant antfile="build.xml" target="javacc"/>

        <javadoc destdir="${javadoc.dir}"
                 author="true" version="true" use="true"
                 public="true"
                 windowtitle="CDK API">
            <classpath refid="project.class.path" />
            <tag name="keyword" scope="all" description="Keywords:" />
            <tag name="created" scope="all" description="Created on:" />
            <tag name="jar"     scope="all" description="Requires the Library:" />
            <packageset dir="${build}/${src}" defaultexcludes="yes">
                <include name="org/openscience/cdk/**" />
                <exclude name="org/openscience/cdk/test/**"/>
                <exclude name="org/openscience/cdk/applications/**"/>
            </packageset>
        </javadoc>
    </target>

    <target name="core.docbook">
        <javadoc private="false" public="true"
                 excludepackagenames="org.openscience.cdk.test.*">
            <classpath refid="project.class.path" />

            <doclet name="com.mf.doclet.docbook.DocBookDoclet"
                    path="jar/dbdoclet.jar">
                <param name="-properties" value="jar/dbdoclet.properties"/>
            </doclet>
            <package name="org.openscience.cdk"/>
            <sourcepath>
                <pathelement path="${src}"/>
            </sourcepath>
        </javadoc>
        <copy file="javadoc.dbxml"
              tofile="core.dbxml" />
    </target>

    <target name="core.fo">
        <!-- alternatively, you can use the much faster xsltproc -->
        <java classname="org.apache.xalan.xslt.Process"
              args="-IN core.dbxml -XSL doc/lib/xslt/docbook/fo/docbook.xsl -OUT core.fo"
              dir="." fork="yes">
            <classpath refid="fop.class.path" />
        </java>
    </target>

    <target name="core.pdf">
        <java classname="org.apache.fop.apps.Fop"
              args="-fo core.fo -pdf core.pdf"
              dir="." fork="yes">
            <classpath refid="fop.class.path" />
        </java>
    </target>

  <target name="jjdoc" description="Create JJDoc documentation from the .jj file">   
    <mkdir dir="doc/iupac-parser"/>
    <jjdoc target="${src}/org/openscience/cdk/iupac/parser/NomParser.jj"
      outputfile="doc/iupac-parser/ParserBNF.html"
      javacchome="jar"/>
  </target>

</project>



